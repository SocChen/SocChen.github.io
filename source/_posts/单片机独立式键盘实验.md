---
title: 单片机独立式键盘实验
date: 2019-03-06 01:07:05
tags: [单片机实验]
categories: [单片机]
---

## 实验内容
独立式键盘，4个按键，编号0-3，按下一个按键，LED显示其键号(非中断)

## 实验环境
> uVision 5
> Protues 8 Professional

## 实验元器件
>单片机(AT89C51)
>按键(button)
>共阳极数码管灯(7SEG-COM-AN-BULE)
>电阻(res)

## 实验原理图
![](实验原理图.png)

## 程序
```c
#include<reg51.h>
#define uchar unsigned char

uchar code seg[]={0xc0,0xf9,0xa4,0xb0};
sbit S0=P1^0;
sbit S1=P1^1;
sbit S2=P1^2;
sbit S3=P1^3;
uchar key;

void key_scan();
void delay10ms();

void main(){
    key=0;
    while(1){
        key_scan();
        P2=seg[key];
    }
}

void key_scan(){
    P1=0xff;
    if((P1&0x0f)!=0x0f){
        delay10ms();
        if(S0==0) key=0;
        if(S1==0) key=1;
        if(S2==0) key=2;
        if(S3==0) key=3;

    }
}

//防抖消除
void delay10ms(){
    uchar i,j;
    for(i=0;i<100;i++){
        for(j=0;j<100;j++);
    }
}
```
